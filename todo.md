ეს არის https://github.com/hazardland/gitlab.pg გიტლაბის დოკერების იმიჯის რეპო, სადაც სამი დოკერის იმიჯი მოიაზრება ამ ეტაპზე:

* pg-build.Dockerfile - ამას გამოვიყენებთ არტეფაქტის დასაბილდად და artifact ბრენჩზე მერჯ რექუესთის გასაშვებად
* pg-deploy.Dockerfile - ამას გამოვიყენებთ არტიფაქტის დეპლოის დროს
* pg-create.Dockerfile - ამას გამოვიყენებთ ბრენჩის შექმნისთვის

ყველა დოკერის ფაილს აქვს თავისი .bat ფაილი (მაგ pg-build.ბატ) რომელიც ბილდავს იმიჯს და აქვეყნებს აჭარაბეტის დოკერჰაბის ექაუნთის ქვეშ (მაგალითად გვაქვს უკვე adjarabet/pg-build:latest), გიტლაბის დოკერის იმიჯებში ცვლილებების შესატანად ეს რეპოზიტორი გამოვიყენოთ (ნუ ვიდრე ჩვენს gitlab-ზე გადავიტანთ ყველაფერს)

თუ წინა კვირის თასქებს მოვრჩით შეგვიძლია შემდეგ ამეებზე გადავიდეთ:

1. pb-build ფაილფლაინის დოკერის იმიჯში დავაგენერიროთ სამაგალითო არტეფაქტი და გავუშვათ სპეციალურ artefact-ბრენჩზე (აქ გვჭირდება წინა თასქი ENV ცვლადები გვქონდეს დოკერის იმიჯში რომ გავიგოთ რას და სად ვმერჯავთ და რომელი დატაბეიზისთვის და ასევე წინა თასქის დაბილდვის დოკერის pg-build.Dockerfile-ის შესაბამისი იმიჯს გაშვება დამერჯვის ფაიფლაინში):

2. გიტლაბში მოვაწყოთ artifact ბრენჩზე რევიუს პროცესი:
    . მხოლოდ ამ ბრენჩზე რევიუს გარეშე არ იმერჯებოდეს
    . ამ ბრენჩზე დაპუშვა იწვევდეს რევიუს
    . რევიუს წარმატებით გავლის შემთხევაში ესვებოდეს pg-deploy ფაიფლაინი
    (ეს ქვე პუნქტები შეიძლება შეიცვალოს თუ რამე არ გამოვიდა)

3. artifact-ბრენჩზე ავაწყოთ დამერჯვის (pg-deply.Dockerfile-ით) ფაიფლაინი რომელიც გაეშვება რევიუს გავლის შემთხვევაში:
    . ფაიფლაინი უნდა ეშვებოდეს მხოლოდ artifact-ბრენჩზე დამერჯვის დროს
    . აქაც უნდა გვქონდეს გარედან custom ENV ცვლადები + გიტლაბის ENV
    
